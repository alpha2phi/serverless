service: grabql-api

# app and org for use with dashboard.serverless.com
# app: grabql
# org: mengwangk

# Create an optimized package for our functions
package:
  individually: true

plugins:
  - serverless-bundle # Package our functions with Webpack
  - serverless-offline
  - serverless-dotenv-plugin # Load .env as environment variables

custom:
  region: ${opt:region, self:provider.region}
  stage: ${opt:stage, self:provider.stage}

provider:
  name: aws
  runtime: nodejs12.x
  lambdaHashingVersion: 20201221

  # support for all binary media types
  # https://www.serverless.com/framework/docs/providers/aws/events/apigateway/
  apiGateway:
    binaryMediaTypes:
      - '*/*'

  # you can overwrite defaults here
  stage: dev
  region: ap-southeast-1

  # To load environment variables externally
  # rename env.example to .env and uncomment
  # the following line. Also, make sure to not
  # commit your .env.
  #
  # environment:
  #   SAMPLE_ENV_VAR: ${env:SAMPLE_ENV_VAR}

functions:
  scraper:
    handler: scraper.main
    events:
      - http:
          path: scrape
          method: get
          request:
            contentHandling: CONVERT_TO_BINARY

  # hello:
  #   handler: hello.main
  #   events:
  #     - http:
  #         path: hello
  #         method: get

  # hello_graphql:
  #   handler: hello_graphql.main
  #   events:
  #     - http:
  #         path: hello_graphql
  #         method: get

#   mock_graphql:
#     handler: mock_graphql.main
#     events:
#       - http:
#           path: mock_graphql
#           method: post
